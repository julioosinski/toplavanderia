â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ESP32 LAVADORA - GUIA DE INSTALAÃ‡ÃƒO                 â•‘
â•‘                         VersÃ£o 2.0.2 - CORRIGIDA                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ RESUMO DAS CORREÃ‡Ã•ES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… Problema identificado: Edge function exigia autenticaÃ§Ã£o JWT
âœ… SoluÃ§Ã£o implementada: FunÃ§Ã£o configurada para aceitar requisiÃ§Ãµes sem JWT
âœ… CÃ³digo Arduino atualizado com header apikey correto
âœ… Heartbeat agora inclui laundry_id obrigatÃ³rio


ğŸ”§ PASSO 1: BAIXAR O CÃ“DIGO CORRIGIDO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Arquivo: ESP32_Lavadora_Individual_CORRIGIDO_v2.ino
ğŸ“ LocalizaÃ§Ã£o no projeto: public/arduino/

Para baixar:
1. Acesse o modo Dev no Lovable
2. Navegue atÃ©: public/arduino/
3. Clique com botÃ£o direito no arquivo
4. Selecione "Download"


âš™ï¸ PASSO 2: CONFIGURAR O CÃ“DIGO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Abra o arquivo no Arduino IDE e configure:

1ï¸âƒ£ WIFI (Linhas 23-24):
   const char* ssid = "SEU_WIFI_AQUI";
   const char* password = "SUA_SENHA_AQUI";

2ï¸âƒ£ IDs (Linhas 31-32):
   #define LAUNDRY_ID "8ace0bcb-83a9-4555-a712-63ef5f52e709"
   #define ESP32_ID "main"

   âš ï¸ IMPORTANTE: Use IDs Ãºnicos para cada ESP32:
   - main (principal)
   - secondary (secundÃ¡rio)
   - esp32_cj01, esp32_cj02, etc.


ğŸ“¤ PASSO 3: UPLOAD PARA O ESP32
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Conecte o ESP32 ao computador via USB
2. No Arduino IDE:
   - Selecione a placa: ESP32 Dev Module
   - Selecione a porta COM correta
3. Clique em "Upload" (â†’)
4. Aguarde a compilaÃ§Ã£o e upload


âœ… PASSO 4: VERIFICAR FUNCIONAMENTO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ MONITOR SERIAL (Arduino IDE):
   VocÃª DEVE ver estas mensagens:
   
   âœ… WiFi conectado com sucesso!
      IP: 192.168.0.XX
      Sinal: -XX dBm
   âœ… Servidor web iniciado na porta 80
   ğŸ“¡ Enviando heartbeat...
   âœ… Heartbeat enviado - HTTP 200

   âŒ Se aparecer HTTP 401/403: Aguarde deploy automÃ¡tico
   âŒ Se aparecer "WiFi desconectado": Verifique SSID/senha

2ï¸âƒ£ INTERFACE WEB DO ESP32:
   - Abra o navegador
   - Acesse: http://192.168.0.XX (IP mostrado no Serial)
   - VocÃª deve ver a interface de controle
   - Teste os botÃµes Iniciar/Parar

3ï¸âƒ£ SISTEMA ADMIN (Lovable):
   - Acesse /admin/machines
   - ApÃ³s 30 segundos, a mÃ¡quina deve aparecer ONLINE âœ…
   - Status do ESP32 deve mostrar sinal WiFi
   - IP do ESP32 deve ser exibido


ğŸ” TROUBLESHOOTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ Problema: "HTTP 401 Unauthorized"
   âœ… SoluÃ§Ã£o: Aguarde o deploy automÃ¡tico da edge function (1-2 minutos)
   âœ… A funÃ§Ã£o foi configurada para nÃ£o exigir autenticaÃ§Ã£o

âŒ Problema: "MÃ¡quina nÃ£o aparece online no sistema"
   âœ… Verifique se o laundry_id estÃ¡ correto
   âœ… Verifique se o esp32_id Ã© Ãºnico
   âœ… Aguarde atÃ© 60 segundos para o primeiro heartbeat

âŒ Problema: "WiFi nÃ£o conecta"
   âœ… Verifique SSID e senha (case sensitive)
   âœ… Certifique-se que o WiFi Ã© 2.4GHz (ESP32 nÃ£o suporta 5GHz)
   âœ… Verifique se hÃ¡ firewall bloqueando

âŒ Problema: "CompilaÃ§Ã£o falha"
   âœ… Instale a biblioteca ArduinoJson (Gerenciador de Bibliotecas)
   âœ… Verifique se a placa ESP32 estÃ¡ instalada


ğŸ“Š DADOS TÃ‰CNICOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
URL Edge Function: https://rkdybjzwiwwqqzjfmerm.supabase.co/functions/v1/esp32-monitor
Endpoint Heartbeat: ?action=heartbeat
MÃ©todo: POST
Headers: 
  - Content-Type: application/json
  - apikey: [INCLUÃDO NO CÃ“DIGO]

Intervalo de Heartbeat: 30 segundos
Timeout: MÃ¡quina offline apÃ³s 5 minutos sem heartbeat


ğŸ†˜ SUPORTE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Se apÃ³s seguir todos os passos ainda houver problemas:

1. Envie o log completo do Monitor Serial
2. Verifique os logs da edge function no Supabase
3. Confirme que o deploy foi concluÃ­do

Links Ãºteis:
- Logs Edge Function: https://supabase.com/dashboard/project/rkdybjzwiwwqqzjfmerm/functions/esp32-monitor/logs
- Tabela ESP32 Status: https://supabase.com/dashboard/project/rkdybjzwiwwqqzjfmerm/editor


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    Ãšltima atualizaÃ§Ã£o: 2025-10-06
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
